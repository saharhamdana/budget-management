<div class="d-flex flex-column min-vh-100 bg-light">
  <!-- Navbar -->
  <!-- <app-navbar></app-navbar> -->

  <!-- Page content wrapper -->
  <div class="main-wrapper d-flex flex-grow-1 overflow-hidden">
    
    <!-- Sidebar (fixe √† gauche) -->
    <div class="sidebar bg-white border-end shadow-sm">
      <app-sidebar></app-sidebar>
    </div>

    <!-- Main content (scrollable) -->
    <div class="content-area flex-grow-1 overflow-auto p-4">
      
      <!-- Upload Section -->
      <div class="card custom-card mb-4 shadow-sm">
        <div class="card-body">
          <h5 class="section-title mb-3">üì§ Upload Excel File</h5>
          <div class="input-group">
            <input type="file" class="form-control" id="inputGroupFile02" (change)="handleFileInput($event)" accept=".xlsx, .xls" />
            <label class="input-group-text btn btn-accent text-white" for="inputGroupFile02">Upload</label>
          </div>
        </div>
      </div>

      <!-- Filter Section -->
      <div class="card custom-card mb-4 shadow-sm">
        <div class="card-body">
          <h5 class="section-title mb-3">üîç Filters</h5>
          <div class="row g-3">
            <div class="col-md-4">
              <input type="text" class="form-control" placeholder="Filter by name" [(ngModel)]="filterName" (ngModelChange)="filterTransactions()" />
            </div>
            <div class="col-md-4">
              <input type="text" class="form-control" placeholder="Global filter..." [(ngModel)]="globalFilter" (ngModelChange)="filterTransactions()" />
            </div>
          </div>
        </div>
      </div>

      <!-- Transactions Table -->
      <div *ngIf="filteredTransactions.length > 0; else noData" class="card custom-card shadow-sm">
        <div class="card-body">
          <h5 class="section-title mb-3">üìä Transactions</h5>
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead class="table-primary">
                <tr>
                  <th *ngFor="let key of getDisplayKeys(filteredTransactions[0])">{{ key }}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of filteredTransactions">
                  <td *ngFor="let key of getDisplayKeys(row)">
                    <ng-container *ngIf="key !== 'categorie'">
                      {{ row[key] }}
                    </ng-container>
                    <ng-container *ngIf="key === 'categorie'">
                      <ng-container *ngIf="!row[key]">
                        <button class="btn btn-sm btn-outline-primary" (click)="affecterCategorie(row)">Affecter</button>
                      </ng-container>
                      <ng-container *ngIf="row[key]">
                        {{ row[key] }}
                      </ng-container>
                    </ng-container>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- No Data Template -->
      <ng-template #noData>
        <div class="alert alert-info text-center">No data loaded.</div>
      </ng-template>
    </div>
  </div>
</div>
